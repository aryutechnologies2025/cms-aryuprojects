{%
  set classes = [
    'block',
    'block-' ~ configuration.provider|clean_class,
    'block-' ~ configuration.label|replace({' ': '-'})|lower,
    attributes.id,
    'block-' ~ plugin_id|clean_class,
    'max-col-' ~ content.field_max_columns[0]['#markup'],
    (content.field_accordion.0['#markup'] == '1' ? 'accordioned' )
  ]
%}
<div{{attributes.addClass(classes)}}>
  {{ title_prefix }}
  {{ title_suffix }}

  {{ content|without('field_link','field_group_by','field_max_columns','field_accordion','field_additional_services') }}

  {% block content %}
    {% if content.field_additional_services.0['#markup'] == '1' %}
      {% set groupedBy = 'block_group_add_' ~ (content.field_group_by.0['#markup'] == '' ? 'none' : content.field_group_by.0['#markup']) %}
    {% else %}
      {% set groupedBy = 'block_group_' ~ (content.field_group_by.0['#markup'] == '' ? 'none' : content.field_group_by.0['#markup']) %}
    {% endif %}
    {{ drupal_view((subsite == '_main' ? 'areas_serviced_service_page' : 'areas_serviced_service_page_subsite'), groupedBy) }}
  {% endblock %}

  <div>{{ content.field_link }}</div>
</div>
