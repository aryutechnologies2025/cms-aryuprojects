diff --git a/modules/contrib/path_redirect_import/src/ImporterService.php b/modules/contrib/path_redirect_import/src/ImporterService.php
index 2971c2bca..72d10f130 100644
--- a/modules/contrib/path_redirect_import/src/ImporterService.php
+++ b/modules/contrib/path_redirect_import/src/ImporterService.php
@@ -2,6 +2,7 @@
 
 namespace Drupal\path_redirect_import;
 
+use Drupal\Core\Entity\EntityStorageException;
 use Drupal\redirect\Entity\Redirect;
 use Drupal\Component\Utility\UrlHelper;
 use Drupal\Core\Url;
@@ -232,8 +233,8 @@ public static function save(array $redirect_array, $override) {
       $message_type = 'Added';
       $parsed_url = UrlHelper::parse(trim($redirect_array['source']));
       $path = isset($parsed_url['path']) ? $parsed_url['path'] : NULL;
+      $path = rtrim($path, '/');
       $query = isset($parsed_url['query']) ? $parsed_url['query'] : NULL;
-
       /** @var \Drupal\redirect\Entity\Redirect $redirect */
       $redirectEntityManager = \Drupal::entityTypeManager()->getStorage('redirect');
       $redirect = $redirectEntityManager->create();
@@ -249,7 +250,17 @@ public static function save(array $redirect_array, $override) {
     }
     $redirect->setStatusCode($redirect_array['status_code']);
     $redirect->setLanguage($redirect_array['language']);
-    $redirect->save();
+    try {
+      $redirect->save();
+    }
+    catch (EntityStorageException $e) {
+      $message = $e->getMessage();
+      if(preg_match("#Duplicate entry '[A-Za-z0-9]+' for key 'hash'#", $message)) {
+        //redirectExists didn't work for some reason
+        return;
+      }
+      throw $e;
+    }
     \Drupal::messenger()->addStatus(t('@message_type redirect from @source to @redirect', [
       '@message_type' => $message_type,
       '@source' => $redirect_array['source'],
@@ -391,6 +402,13 @@ protected static function redirectExists(array $row) {
     $parsed_url = UrlHelper::parse(trim($row['source']));
     $path = isset($parsed_url['path']) ? $parsed_url['path'] : NULL;
     $query = isset($parsed_url['query']) ? $parsed_url['query'] : NULL;
+
+    /** @var \Drupal\redirect\Entity\Redirect $redirect */
+    $redirectEntityManager = \Drupal::entityTypeManager()->getStorage('redirect');
+    $redirect = $redirectEntityManager->create();
+    $redirect->setSource($path, $query);
+    $path = rtrim($redirect->redirect_source->path, '/');
+    $query = (array) $redirect->redirect_source->query;
     $hash = Redirect::generateHash($path, $query, $row['language']);
 
     // Search for duplicate.
